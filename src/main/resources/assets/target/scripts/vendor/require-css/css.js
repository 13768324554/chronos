define(["./normalize","module"],function(e,t){if(typeof window=="undefined")return{load:function(e,t,n){n()}};var n=document.getElementsByTagName("head")[0],r=window.navigator.userAgent.match(/Chrome\/([^ \.]*)|MSIE ([^ ;]*)|Firefox\/([^ ;]*)|Version\/([\d\.]*) Safari\//),i=window.opera?"opera":"";r&&(r[4]&&(i="webkit"),r[3]?i="mozilla":r[2]?i="ie":r[1]&&(i="webkit"));var s=i&&(parseInt(r[4])>5||parseInt(r[3])>8||parseInt(r[2])>9||parseInt(r[1])>18)||undefined,o=t.config();o&&o.useLinks!==undefined&&(s=o.useLinks);var u=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a={},f=function(e,t,n){if(a[e]){t(a[e]);return}var r,i,s;if(typeof XMLHttpRequest!="undefined")r=new XMLHttpRequest;else if(typeof ActiveXObject!="undefined")for(i=0;i<3;i+=1){s=u[i];try{r=new ActiveXObject(s)}catch(o){}if(r){u=[s];break}}r.open("GET",e,requirejs.inlineRequire?!1:!0),r.onreadystatechange=function(i){var s,o;r.readyState===4&&(s=r.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n(o)):(a[e]=r.responseText,t(r.responseText)))},r.send(null)},l={};l.pluginBuilder="./css-builder";var c=document.createElement("style");c.type="text/css",n.appendChild(c),c.styleSheet?l.inject=function(e){c.styleSheet.cssText+=e}:l.inject=function(e){c.appendChild(document.createTextNode(e))};var h=function(e,t){setTimeout(function(){for(var n=0;n<document.styleSheets.length;n++){var r=document.styleSheets[n];if(r.href==e.href)return t()}h(e,t)},10)},p=function(e,t){setTimeout(function(){try{return e.sheet.cssRules,t()}catch(n){}p(e,t)},10)},d=function(e){var t=document.createElement("link");return t.type="text/css",t.rel="stylesheet",t.href=e,t};l.linkLoad=function(e,t){if(i=="webkit"){var s=d(e);h(s,t),n.appendChild(s)}else if(i=="mozilla"&&r[3]<18){var o=document.createElement("style");o.textContent='@import "'+e+'"',p(o,t),n.appendChild(o)}else{var s=d(e);s.onload=t,n.appendChild(s)}},l.inspect=function(){if(c.styleSheet)return c.styleSheet.cssText;if(c.innerHTML)return c.innerHTML},l.normalize=function(e,t){return e.substr(e.length-4,4)==".css"&&(e=e.substr(0,e.length-4)),t(e)};var v=/@import\s*(url)?\s*(('([^']*)'|"([^"]*)")|\(('([^']*)'|"([^"]*)"|([^\)]*))\))\s*;?/g,m=window.location.pathname.split("/");m.pop(),m=m.join("/")+"/";var g=function(t,n,r){t.substr(0,1)!="/"&&(t="/"+e.convertURIBase(t,m,"/")),f(t,function(i){i=e(i,t,m);var s=[],o=[],u=[],a;while(a=v.exec(i)){var f=a[4]||a[5]||a[7]||a[8]||a[9];f.indexOf(".")==-1&&(f+=".less"),s.push(f),o.push(v.lastIndex-a[0].length),u.push(a[0].length)}var l=0;for(var c=0;c<s.length;c++)(function(e){g(s[e],function(t){i=i.substr(0,o[e])+t+i.substr(o[e]+u[e]);var r=t.length-u[e];for(var a=e+1;a<s.length;a++)o[a]+=r;l++,l==s.length&&n(i)},r)})(c);s.length==0&&n(i)},r)};return l.load=function(e,t,n,r,i){var o=e;o.substr(o.length-4,4)!=".css"&&!i&&(o+=".css"),o=t.toUrl(o),!i&&s!==!1&&(o.substr(0,7)=="http://"||o.substr(0,8)=="https://"||s)?l.linkLoad(o,function(){n(l)}):g(o,function(e){i&&(e=i(e)),l.inject(e),n(l)},n.error)},l});