define(["backbone","underscore","models/dependent_job","models/scheduled_job","components/pollable_collection","components/functor"],function(e,t,n,r,i,s){var o;return o=e.Collection.extend(t.extend({},i,{model:function(e,t){return e.parents&&e.parents.length?new n(e,t):new r(e,t)},url:"/scheduler/jobs",initialize:function(){this.listenTo(this,{add:this.parseSchedule,reset:this.parseAllSchedules,"toggle:count":this.toggleCount,"toggle:name":this.toggleName})},parseAllSchedules:function(e){e.each(this.parseSchedule,this)},parseSchedule:function(e){return e.parseSchedule(),this},comparator:function(e){return e.getInvocationCount()},setComparator:function(e){this.comparator=e,this.sort()},makeComparatorByAttribute:function(e,t){return function(n,r){var i=n.get(e).toString(),s=r.get(e).toString(),o=i.localeCompare(s),u=o/Math.abs(o);return o===0||isNaN(o)?0:t?-1*u:u}},toggleCount:function(e){e==="success"?this.toggleCountSuccess():e==="error"&&this.toggleCountError()},toggleCountSuccess:function(){var e=this.countSuccessDirection==="up";this.setComparator(this.makeComparatorByAttribute("successCount",e)),this.countSuccessDirection=e?"down":"up"},toggleCountError:function(){var e=this.countErrorDirection==="up";this.setComparator(this.makeComparatorByAttribute("errorCount",e)),this.countErrorDirection=e?"down":"up"},toggleName:function(){var e=this.sortNameDirection==="up";this.setComparator(this.makeComparatorByAttribute("displayName",e)),this.sortNameDirection=e?"down":"up"},toggleLastRun:function(){var e=this.sortLastRunDirection==="up";this.setComparator(this.makeComparatorByAttribute("lastRunStatus",e)),this.sortLastRunDirection=e?"down":"up"},reverse:function(){this.models.reverse(),this.trigger("filter")},counts:{},count:function(e){var t=this.counts[e]||0;return this.counts[e]=t+1,this},getCounts:function(){return t.values(this.counts)},getDates:function(){var e=this.pluck("startDate");return t.reject(e,function(e){return t.isUndefined(e)})},getRelatedTo:function(e,n){var r=this.get(e),i=[r];return n||(n===0?n:n=1),this.reduce(function(n,r){var i=r.get("name"),o=r.get("parents"),u=i===e,a=t.contains(o,e);if(u||a||n[i]){var f=o.concat(i);t.extend(n,t.object(f,t.times(f.length,s(!0))))}return n},{})}})),o});